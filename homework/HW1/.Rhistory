## set default to display R code in our analysis
knitr::opts_chunk$set(echo = TRUE)
## disable comments from xtable
options(xtable.comment = FALSE)
library(data.table)
library(ggplot2)
library(ggrepel)
library(faraway)
library(xtable)
dat <- as.data.table(na.omit(diabetes[, c("glyhb", "weight", "age","gender")]))
print(xtable(head(dat)))
ggplot(data = dat) +
geom_point(aes(x = weight, y = glyhb)) +
theme_minimal() +
facet_wrap(~gender) +
scale_x_continuous(minor_breaks = NULL) +
scale_y_continuous(minor_breaks = NULL)
ggplot(data = dat) +
geom_point(aes(x = age, y = glyhb)) +
theme_minimal() +
facet_wrap(~gender) +
scale_x_continuous(minor_breaks = NULL) +
scale_y_continuous(minor_breaks = NULL)
m1 <- lm(glyhb ~ weight + age + gender, data = (dat))
print(xtable(summary(m1)))
temp_preds <- predict(m1, type = "response", se.fit = T)
dat[, preds := predict(m1, type = "response")]
dat[, upCI := temp_preds$fit + 1.96 * temp_preds$se.fit]
dat[, lowCI := temp_preds$fit - 1.96 * temp_preds$se.fit]
ggplot(data = na.omit(dat)) +
geom_point(aes(x = weight, y = glyhb)) +
geom_line(aes(x = weight, y = preds), col = "red") +
geom_ribbon(aes(ymax = upCI, ymin = lowCI, x= weight), alpha = 0.1) +
theme_minimal() +
facet_wrap(~gender) +
scale_x_continuous(minor_breaks = NULL) +
scale_y_continuous(minor_breaks = NULL)
